{% extends 'base.html' %}

{% block toc %}
<h5>Sections</h5>
<ul class="section table-of-contents" style="white-space: nowrap;">
  {%- for section in sections %}
  <li><a href="#{{section.title | replace(" ", "_") | lower}}">{{section.title}}</a></li>
  {%- endfor %}
</ul>
{% endblock %}


{% block controls %}

{%- for section in sections %}
<div id="{{section.title | replace(" ", "_") | lower}}" class="scrollspy">
<h2>{{ section.title }}</h2>
{%- for item in section.item_list %}
<form id="controls_form_{{ item.name }}" class="controls-form">
  <div class="row">
    <div class="col s1">
      {%- if item.state != None %}
        <i id="state_{{ item.name }}" class="tiny material-icons cyan-text text-darken-2 right">
          {%- if item.state %}
          radio_button_checked
          {%- else %}
          radio_button_unchecked
          {%- endif %}
        </i>
      {%- else %}
        {# This else statement is needed to maintain spacing. #}
        &nbsp;
      {%- endif %}
    </div>
    <div class="col s2 m1">
    {%- if item.enable_graph %}
      <a class="graph_link" href="graph/{{ item.name }}.svg">
        <i class="material-icons hoverable black-text">insert_chart</i>
      </a>
    {%- endif %}
    </div>
    <div class="col s9 m3">
      <span id="label_{{ item.name }}" class="truncate">{{ item.desc }}</span>
    </div>
    <div class="col s12 m6">
    {%- for input in item.inputs %}
      {%- if input.type == "text" %}
        <input {% if item.disabled %}disabled="disabled"{% endif %}
               type="text"
               id="command_{{ item.name }}_{{ input.command }}"
               class="command" data-item="{{ item.name }}"
               data-command="{{ input.command }}"
               data-use-val="true"
               data-event="change"
               {%- if item.state != None %}value="{{ item.state }}"{% endif %}
               />
      {%- elif input.type == "button" %}
        <input {% if item.disabled %}disabled="disabled"{% endif %}
               type="button"
               id="command_{{ item.name }}_{{ input.command }}"
               class="command btn waves-light"
               data-item="{{ item.name }}"
               data-command="{{ input.command }}"
               data-use-val="false"
               data-event="click"
               value="{{ input.command|title }}"
               />
      {%- elif input.type == "number" %}
        <input {% if item.disabled %}disabled="disabled"{% endif %}
               type="number"
               id="command_{{ item.name }}_{{ input.command }}"
               class="command"
               data-item="{{ item.name }}"
               data-command="{{ input.command }}"
               data-use-val="true"
               data-event="change"
               {%- if item.state != None %} value="{{ item.state }}"{% endif %}
               />
      {%- elif input.type == "checkbox" %}
        <input {% if item.disabled %}disabled="disabled"{% endif %}
               type="checkbox"
               id="command_{{ item.name }}_{{ input.command }}"
               class="command"
               data-item="{{ item.name }}"
               data-command="{{ input.command }}"
               data-use-val="true"
               data-event="click"/>
      {%- elif input.type == "scene" %}
        <div class="switch">
          <label>
            Exit
            <input type="checkbox"
                   id="scene_enter_{{ item.name }}"
                   class="scene-control scene-enter btn waves-light"
                   data-scene="{{ item.name }}"
                   data-action="{{ "exit" if item.state else "enter" }}"
                   {% if item.state %}checked=""{% endif %}/>
            <span class="lever"></span>
            Enter
          </label>
        </div>
      {%- endif %}
    {%- endfor %}
    </div>
    <div class="col s6 m1">
      {%- if item.show_disable %}
        <input type="checkbox"
               id="disable_{{ item.name }}"
               class="disable filled-in"
               data-item="{{ item.name }}"
               value="true"
               {% if item.disabled %}checked="checked"{% endif %}
               />
        <label for="disable_{{ item.name }}">Disable</label>
      {%- endif %}
    </div>
    <div class="col s6 m4">
    {%- if item.show_sparkline %}
      <embed type="image/svg+xml" src="sparkline/{{ item.name }}.svg"/>
    {%- endif %}
    </div>
  </div>
</form>
{% endfor %}
</div>
{% endfor %}
{% endblock %}
